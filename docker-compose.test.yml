services:
  service_test:
    build:
      context: ./service/
      dockerfile: Dockerfile.test
    environment:
      - JUPYTER_PLATFORM_DIRS=1
      - COVERAGE_FILE=/tmp/.coverage
      - PYTHONPATH=/
    ports:
      - 8888:8888
    user: "0:0"
    tty: false
    restart: no
    image: local/service-test:ci
    volumes:
      - ./service/app:/app
      - ./service/data:/data
      - ./service/tests:/tests
      - ./service/reports:/reports
      - ./service/root/jupyter:/root/.jupyter
    command: ["pytest", "-q"]
